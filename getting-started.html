<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Feb 11, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="The MyBatis Team" />
    <meta name="Date-Revision-yyyymmdd" content="20130211" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MyBatis - 
    MyBatis Guice | Getting started</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../" id="bannerLeft" title="MyBatis logo">
                                                                                                <img src="../images/logo.png"  alt="MyBatis logo"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 11 February 2013</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 3.4-SNAPSHOT</li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Reference Documentation</li>
                                
      <li>
    
                          <a href="index.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Getting Started</a>
          </li>
                  
      <li>
    
                          <a href="core.html" title="Core components">
          <i class="none"></i>
        Core components</a>
            </li>
                                                                                                                    
      <li>
    
                          <a href="datasources.html" title="Data Sources">
          <i class="icon-chevron-down"></i>
        Data Sources</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="datasources/builtin.html" title="MyBatis built-in">
          <i class="none"></i>
        MyBatis built-in</a>
            </li>
                      
      <li>
    
                          <a href="datasources/dbcp.html" title="Apache Commons DBCP">
          <i class="none"></i>
        Apache Commons DBCP</a>
            </li>
                      
      <li>
    
                          <a href="datasources/c3p0.html" title="C3P0">
          <i class="none"></i>
        C3P0</a>
            </li>
                      
      <li>
    
                          <a href="datasources/bonecp.html" title="BoneCP">
          <i class="none"></i>
        BoneCP</a>
            </li>
              </ul>
        </li>
                  
      <li>
    
                          <a href="injections.html" title="Injections">
          <i class="none"></i>
        Injections</a>
            </li>
                  
      <li>
    
                          <a href="transactional.html" title="@Transactional">
          <i class="none"></i>
        @Transactional</a>
            </li>
                  
      <li>
    
                          <a href="jdbc-helper.html" title="JDBC Helper">
          <i class="none"></i>
        JDBC Helper</a>
            </li>
                  
      <li>
    
                          <a href="samples.html" title="Samples">
          <i class="none"></i>
        Samples</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                          
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                                                        
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!-- Copyright 2010-2012 The MyBatis Team

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. --><!-- version: $Id$ -->

  
    <div class="section"><h2>Getting started<a name="Getting_started"></a></h2>
  <p>
    MyBatis-Guice helps you integrate your MyBatis code seamlessly with
    Google Guice. Using the classes in this library, Google Guice will load
    the necessary MyBatis classes for you. This library also provides
    an easy way to inject MyBatis data mappers and <tt>SqlSessions</tt>
    into your application beans.
    Finally, MyBatis-Guice will let you demarcate transactions declaratively
    so you won't need to commit/rollback/close them by hand.
  </p>
  </div>

  <div class="section"><h2>Installation<a name="Installation"></a></h2>
        <p>
            Installing the mybatis-guice module it is very easy, just put the
            <tt>mybatis-guice-X.X.jar</tt> and
            dependencies in the classpath!
        </p>
        <p>
            Apache Maven users instead can easily adding the following dependency
            in their POMs :
            </p><div class="source"><pre class="prettyprint">&lt;dependencies&gt;
...
  &lt;dependency&gt;
    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-guice&lt;/artifactId&gt;
    &lt;version&gt;X.X&lt;/version&gt;
  &lt;/dependency&gt;
...
&lt;/dependencies&gt;</pre></div>
        
  </div>

  <div class="section"><h2>Quick Setup<a name="Quick_Setup"></a></h2>
    <p>
      To use MyBatis with Guice you need to set up a <tt>MyBatisModule</tt>,
      with a <tt>DataSource</tt> at least one data mapper class and
      a transactional bean to be injected with the mapper.
    </p>

    <p>
      To setup a <tt>DataSource</tt> you can simply use the <tt>JdbcHelper</tt> (please see the
      related appendix for more informations) module to build the URL needed for your database and provide the
      connection properties:
      </p><div class="source"><pre class="prettyprint">Properties myBatisProperties = new Properties();
myBatisProperties.setProperty(&quot;mybatis.environment.id&quot;, &quot;test&quot;);
myBatisProperties.setProperty(&quot;JDBC.schema&quot;, &quot;mybatis-guice_TEST&quot;);
myBatisProperties.setProperty(&quot;derby.create&quot;, &quot;true&quot;);
myBatisProperties.setProperty(&quot;JDBC.username&quot;, &quot;sa&quot;);
myBatisProperties.setProperty(&quot;JDBC.password&quot;, &quot;&quot;);
myBatisProperties.setProperty(&quot;JDBC.autoCommit&quot;, &quot;false&quot;);

Injector injector = Guice.createInjector(
    JdbcHelper.HSQLDB_Embedded,
    new Module() {
        public void configure(Binder binder) {
            Names.bindProperties(binder, myBatisProperties);
        }
    }
);</pre></div>
   

   <p>
      Assume you have a data mapper class defined like the following:

      </p><div class="source"><pre class="prettyprint">public interface UserMapper {

    @Select(&quot;SELECT * FROM user WHERE id = #{userId}&quot;)
    User getUser(@Param(&quot;userId&quot;) String userId);

}</pre></div>

      Note that the mapper class specified <i>must</i> be an
      interface, not an actual implementation class. In this example,
      annotations are used to specify the SQL, but a MyBatis mapper XML file
      could also be used.
   

   <p>
      Assume you also have a transactional service bean that uses your mapper:

      </p><div class="source"><pre class="prettyprint">public class FooServiceMapperImpl implements FooService {

    @Inject
    private UserMapper userMapper;

    @Transactional
    public User doSomeBusinessStuff(String userId) {
        return this.userMapper.getUser(userId);
    }

}</pre></div>
   

   <p>
      Setup a <tt>MyBatisModule</tt>, add your mapper to it and bind also 
      your transactional service interface <tt>FooService</tt> to its implementation.
      </p><div class="source"><pre class="prettyprint">public interface UserMapper {
...
Injector injector = Guice.createInjector(
    new MyBatisModule() {

        @Override
        protected void initialize() {
            install(JdbcHelper.HSQLDB_Embedded);

            bindDataSourceProviderType(PooledDataSourceProvider.class);
            bindTransactionFactoryType(JdbcTransactionFactory.class);
            addMapperClass(UserMapper.class);

            Names.bindProperties(binder, createTestProperties());
            bind(FooService.class).to(FooServiceMapperImpl.class);
        }

    }
);</pre></div>
   

    <p>
       This is all you need, you can now get an instance of your service. It will
       be automatically injected with the MyBatis mapper. With the mapper calling
       MyBatis data methods is only one line of code. Besides, all operations will 
       be transactional, that means that you will not need to commit or rollback 
       any connection. 
      </p><div class="source"><pre class="prettyprint">FooService fooService = this.injector.getInstance(FooService.class);
fooService.doSomeBusinessStuff(&quot;data&quot;);</pre></div>
     
  </div>

    


                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2010-2013
                        <a href="http://www.mybatis.org/">MyBatis.org</a>.
            All Rights Reserved.      
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
