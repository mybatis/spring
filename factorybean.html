<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from target/site-src/markdown/factorybean.md at 27 May 2025
 | Rendered using Apache Maven Fluido Skin 2.1.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <title>mybatis-spring</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.1.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.1.0.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"><div id="bannerRight"><h1><a href="https://blog.mybatis.org/"><img src="../images/mybatis-logo.png" alt="MyBatis logo" /> MyBatis</a></h1></div></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 11 Aug 2024<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 3.0.5-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Reference Documentation</li>
    <li><a href="index.html">Introduction</a></li>
    <li><a href="getting-started.html">Getting Started</a></li>
    <li class="active"><a>SqlSessionFactoryBean</a></li>
    <li><a href="transactions.html"><span class="icon-chevron-right"></span>Transactions</a></li>
    <li><a href="sqlsession.html"><span class="icon-chevron-right"></span>Using an SqlSession</a></li>
    <li><a href="mappers.html"><span class="icon-chevron-right"></span>Injecting Mappers</a></li>
    <li><a href="boot.html">Spring Boot</a></li>
    <li><a href="using-api.html">Using the MyBatis API</a></li>
    <li><a href="batch.html">Spring Batch</a></li>
    <li><a href="sample.html">Sample Code</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<p></p><section><a id="SqlSessionFactoryBean"></a>
<h1>SqlSessionFactoryBean</h1>
<p>In base MyBatis, the <code>SqlSessionFactory</code> is built using <code>SqlSessionFactoryBuilder</code>. In MyBatis-Spring, <code>SqlSessionFactoryBean</code> is used instead.</p><section><a id="Setup"></a>
<h2>Setup</h2>
<p>To create the factory bean, put the following in the Spring XML configuration file:</p>

<pre class="prettyprint"><code class="language-xml">&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
  &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
&lt;/bean&gt;
</code></pre>
<p>Note that <code>SqlSessionFactoryBean</code> implements Spring's <code>FactoryBean</code> interface see <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#beans-factory-extension-factorybean" class="externalLink">the Spring documentation(Core Technologies -Customizing instantiation logic with a FactoryBean-)</a>).
This means that the bean Spring ultimately creates is <strong>not</strong> the <code>SqlSessionFactoryBean</code> itself, but what the factory returns as a result of the <code>getObject()</code> call on the factory.
In this case, Spring will build an <code>SqlSessionFactory</code> for you at application startup and store it with the name <code>sqlSessionFactory</code>.
In Java, the equivalent code would be:</p>

<pre class="prettyprint"><code class="language-java">@Configuration
public class MyBatisConfig {
  @Bean
  public SqlSessionFactory sqlSessionFactory() {
    SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();
    factoryBean.setDataSource(dataSource());
    return factoryBean.getObject();
  }
}
</code></pre>
<p>In normal MyBatis-Spring usage, you will not need to use <code>SqlSessionFactoryBean</code> or the corresponding <code>SqlSessionFactory</code> directly.
Instead, the session factory will be injected into <code>MapperFactoryBean</code>s or other DAOs that extend <code>SqlSessionDaoSupport</code>.</p></section><section><a id="Properties"></a>
<h2>Properties</h2>
<p><code>SqlSessionFactory</code> has a single required property, the JDBC <code>DataSource</code>. This can be any <code>DataSource</code> and should be configured just like any other Spring database connection.</p>
<p>One common property is <code>configLocation</code> which is used to specify the location of the MyBatis XML configuration file.
One case where this is needed is if the base MyBatis configuration needs to be changed. Usually this will be <code>&lt;settings&gt;</code> or <code>&lt;typeAliases&gt;</code> sections.</p>
<p>Note that this config file does <strong>not</strong> need to be a complete MyBatis config. Specifically, any environments, data sources and MyBatis transaction managers will be <strong>ignored</strong>.
<code>SqlSessionFactoryBean</code> creates its own, custom MyBatis <code>Environment</code> with these values set as required.</p>
<p>Another reason to require a config file is if the MyBatis mapper XML files are not in the same classpath location as the mapper classes. With this configuration, there are two options.
This first is to manually specify the classpath of the XML files using a <code>&lt;mappers&gt;</code> section in the MyBatis config file. A second option is to use the <code>mapperLocations</code> property of the factory bean.</p>
<p>The <code>mapperLocations</code> property takes a list of resource locations. This property can be used to specify the location of MyBatis XML mapper files.
The value can contain Ant-style patterns to load all files in a directory or to recursively search all paths from a base location.</p>
<p>For example:</p>

<pre class="prettyprint"><code class="language-xml">&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
  &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
  &lt;property name=&quot;mapperLocations&quot; value=&quot;classpath*:sample/config/mappers/**/*.xml&quot; /&gt;
&lt;/bean&gt;
</code></pre>
<p>This will load all the MyBatis mapper XML files in the <code>sample.config.mappers</code> package and its sub-packages from the classpath.</p>
<p>One property that may be required in an environment with container managed transactions is <code>transactionFactoryClass</code>. Please see the relevant section in the Transactions chapter.</p>
<p>In case you are using the multi-db feature you will need to set the <code>databaseIdProvider</code> property:</p>

<pre class="prettyprint"><code class="language-xml">&lt;bean id=&quot;databaseIdProvider&quot; class=&quot;org.apache.ibatis.mapping.VendorDatabaseIdProvider&quot;&gt;
  &lt;property name=&quot;properties&quot;&gt;
    &lt;props&gt;
      &lt;prop key=&quot;SQL Server&quot;&gt;sqlserver&lt;/prop&gt;
      &lt;prop key=&quot;DB2&quot;&gt;db2&lt;/prop&gt;
      &lt;prop key=&quot;Oracle&quot;&gt;oracle&lt;/prop&gt;
      &lt;prop key=&quot;MySQL&quot;&gt;mysql&lt;/prop&gt;
    &lt;/props&gt;
  &lt;/property&gt;
&lt;/bean&gt;
</code></pre>

<pre class="prettyprint"><code class="language-xml">&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
  &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
  &lt;property name=&quot;mapperLocations&quot; value=&quot;classpath*:sample/config/mappers/**/*.xml&quot; /&gt;
  &lt;property name=&quot;databaseIdProvider&quot; ref=&quot;databaseIdProvider&quot;/&gt;
&lt;/bean&gt;
</code></pre>
<p><span class="label important">NOTE</span>
Since 1.3.0, <code>configuration</code> property has been added. It can be specified a <code>Configuration</code> instance directly without MyBatis XML configuration file.</p>
<p>For example:</p>

<pre class="prettyprint"><code class="language-xml">&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
  &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
  &lt;property name=&quot;configuration&quot;&gt;
    &lt;bean class=&quot;org.apache.ibatis.session.Configuration&quot;&gt;
      &lt;property name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;
    &lt;/bean&gt;
  &lt;/property&gt;
&lt;/bean&gt;
</code></pre></section></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2010–2025
<a href="https://www.mybatis.org/">MyBatis.org</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
