<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/xdoc/factorybean.xml at 15 July 2019
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Hunter Presnall" />
    <meta name="author" content="Eduardo Macarron" />
    <meta name="Date-Revision-yyyymmdd" content="20190715" />
    <meta http-equiv="Content-Language" content="en" />
    <title>mybatis-spring &#x2013; MyBatis-Spring | SqlSessionFactoryBean</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>mybatis-spring</h2>
</div>
</div>
        <div class="pull-right"><a href="../" id="bannerRight" title="MyBatis logo"><img src="../images/mybatis-logo.png"  alt="MyBatis logo"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 15 July 2019<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.0.2</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Reference Documentation</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="getting-started.html" title="Getting Started"><span class="none"></span>Getting Started</a></li>
    <li class="active"><a href="#"><span class="none"></span>SqlSessionFactoryBean</a></li>
    <li><a href="transactions.html" title="Transactions"><span class="icon-chevron-right"></span>Transactions</a></li>
    <li><a href="sqlsession.html" title="Using an SqlSession"><span class="icon-chevron-right"></span>Using an SqlSession</a></li>
    <li><a href="mappers.html" title="Injecting Mappers"><span class="icon-chevron-right"></span>Injecting Mappers</a></li>
    <li><a href="boot.html" title="Spring Boot"><span class="none"></span>Spring Boot</a></li>
    <li><a href="using-api.html" title="Using the MyBatis API"><span class="none"></span>Using the MyBatis API</a></li>
    <li><a href="batch.html" title="Spring Batch"><span class="none"></span>Spring Batch</a></li>
    <li><a href="sample.html" title="Sample Code"><span class="none"></span>Sample Code</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >


  
    <div class="section">
<h2><a name="SqlSessionFactoryBean"></a>SqlSessionFactoryBean</h2>
      
<p>
        In base MyBatis, the <tt>SqlSessionFactory</tt> is built using
        <tt>SqlSessionFactoryBuilder</tt>. In MyBatis-Spring,
        <tt>SqlSessionFactoryBean</tt> is used instead.
      </p>
      
    
<div class="section">
<h3><a name="Setup"></a>Setup</h3>
      
<p>
        To create the factory bean, put the following in the Spring XML
        configuration file:
      </p>
        
<div class="source"><pre class="prettyprint">
&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
  &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
&lt;/bean&gt;</pre></div>
	  
<p>
        Note that
        <tt>SqlSessionFactoryBean</tt>
        implements Spring's
        <tt>FactoryBean</tt>
        interface (see <a class="externalLink" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#beans-factory-extension-factorybean">the Spring documentation(Core Technologies -Customizing instantiation logic with a FactoryBean-)</a>).
        This means that the bean Spring ultimately creates is
        <b>not</b>
        the
        <tt>SqlSessionFactoryBean</tt>
        itself, but what the
        factory returns as a result of the
        <tt>getObject()</tt>
        call on
        the factory. In this case, Spring will build an
        <tt>SqlSessionFactory</tt>
        for you at application startup and
        store it with the name
        <tt>sqlSessionFactory</tt>
        . In Java, the
        equivalent code would be:
      </p>

      
<div class="source"><pre class="prettyprint">
@Bean
public SqlSessionFactory sqlSessionFactory() {
  SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();
  factoryBean.setDataSource(dataSource());
  return factoryBean.getObject();
}</pre></div>

      
<p>
        In normal MyBatis-Spring usage, you will not need to use
        <tt>SqlSessionFactoryBean</tt>
        or the corresponding
        <tt>SqlSessionFactory</tt>
        directly. Instead, the session
        factory will be injected into
        <tt>MapperFactoryBean</tt>s or
        other DAOs that extend
        <tt>SqlSessionDaoSupport</tt>
        .
      </p>
    </div>

    
<div class="section">
<h3><a name="Properties"></a>Properties</h3>

      
<p>
        <tt>SqlSessionFactory</tt>
        has a single required property, the
        JDBC
        <tt>DataSource</tt>
        . This can be any
        <tt>DataSource</tt>
        and should be configured just
        like any other Spring database
        connection.
      </p>

      
<p>
        One common property is
        <tt>configLocation</tt>
        which is used to
        specify the location of the MyBatis XML
        configuration file. One case
        where this is needed is if the base
        MyBatis configuration needs to be
        changed. Usually this will be
        <tt>&lt;settings&gt;</tt>
        or
        <tt>&lt;typeAliases&gt;</tt>
        sections.
      </p>

      
<p>
        Note that this config file does
        <b>not</b>
        need to be a
        complete MyBatis config. Specifically, any environments,
        data sources
        and MyBatis transaction managers will be
        <b>ignored</b>
        .
        <tt>SqlSessionFactoryBean</tt>
        creates its own, custom MyBatis
        <tt>Environment</tt>
        with these values set as required.
      </p>

      
<p>
        Another reason to require a config file is if the MyBatis mapper XML
        files are not in the same classpath location as the mapper classes.
        With
        this configuration, there are two options. This first is to
        manually
        specify the classpath of the XML files using a
        <tt>&lt;mappers&gt;</tt>
        section in the MyBatis config
        file. A second option is to use the
        <tt>mapperLocations</tt>
        property of the factory bean.
      </p>

      
<p>
        The
        <tt>mapperLocations</tt>
        property takes a list of resource
        locations. This property can be
        used to specify the location of MyBatis
        XML mapper files. The value
        can contain Ant-style patterns to load all
        files in a directory or to
        recursively search all paths from a base
        location. For example:
      </p>
      
        
<div class="source"><pre class="prettyprint">
&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
  &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
  &lt;property name=&quot;mapperLocations&quot; value=&quot;classpath*:sample/config/mappers/**/*.xml&quot; /&gt;
&lt;/bean&gt;</pre></div>

      
<p>
        This will load all the MyBatis mapper XML files in the
        sample.config.mappers package and its sub-packages from the
        classpath.
      </p>

      
<p>
        One property that may be required in an environment with container
        managed transactions is
        <tt>transactionFactoryClass</tt>
        .
        Please see the relevant section in the
        Transactions chapter.
      </p>
      
      
<p>
        In case you are using the multi-db feature you will need to set the <tt>databaseIdProvider</tt> property:  
      </p>
      

<div class="source"><pre class="prettyprint">
&lt;bean id=&quot;databaseIdProvider&quot; class=&quot;org.apache.ibatis.mapping.VendorDatabaseIdProvider&quot;&gt;
  &lt;property name=&quot;properties&quot;&gt;
    &lt;props&gt;
      &lt;prop key=&quot;SQL Server&quot;&gt;sqlserver&lt;/prop&gt;
      &lt;prop key=&quot;DB2&quot;&gt;db2&lt;/prop&gt;
      &lt;prop key=&quot;Oracle&quot;&gt;oracle&lt;/prop&gt;
      &lt;prop key=&quot;MySQL&quot;&gt;mysql&lt;/prop&gt;
    &lt;/props&gt;
  &lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
  &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
  &lt;property name=&quot;mapperLocations&quot; value=&quot;classpath*:sample/config/mappers/**/*.xml&quot; /&gt;
  &lt;property name=&quot;databaseIdProvider&quot; ref=&quot;databaseIdProvider&quot;/&gt;
&lt;/bean&gt;</pre></div>

      
<p>
        <span class="label important">NOTE</span>
        Since 1.3.0, <tt>configuration</tt> property has been added.
        It can be specified a <tt>Configuration</tt> instance directly without MyBatis XML configuration file.
        For example:
      </p>

      
<div class="source"><pre class="prettyprint">
&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
  &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
  &lt;property name=&quot;configuration&quot;&gt;
    &lt;bean class=&quot;org.apache.ibatis.session.Configuration&quot;&gt;
      &lt;property name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;
    &lt;/bean&gt;
  &lt;/property&gt;
&lt;/bean&gt;</pre></div>

    </div>
    </div>
  

        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2010&#x2013;2019
<a href="http://www.mybatis.org/">MyBatis.org</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
